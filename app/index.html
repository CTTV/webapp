<!DOCTYPE html>
<html>
<head>
  <title>CTTV Core</title>
  <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="bower_components/components-font-awesome/css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/app.css">

  <!-- js components -->
  <link rel="stylesheet" href="node_modules/cttv.bubblesView/build/bubblesView.css" />
  <script type="text/javascript" src="node_modules/cttv.bubblesView/build/cttv.bubblesView.js"></script>
  <link rel="stylesheet" href="node_modules/cttv.geneAssociations/build/index.css" />
  <script type="text/javascript" src="node_modules/cttv.geneAssociations/build/cttv.geneAssociations.js"></script>
  <script type="text/javascript" src="node_modules/cttv.api/build/cttv.api.js"></script>

  <!-- Web components -->
  <script type="text/javascript" src="bower_components/webcomponentsjs/webcomponents.js"></script>
  <link rel="import" href="./web_components/cttv/target-evidence/target_evidence.html">
  <link rel="import" href="./web_components/cttv/target-disease-evidence/target-disease-evidence-header/target_disease_evidence_header.html">
  <link rel="import" href="./web_components/cttv/target-disease-evidence/target-disease-evidence-overview/target_disease_evidence_overview.html">
  
</head>

<body ng-app="cttvApp">

    
    <div class="container">


      <!-- Masthead (search) -->
        
        <div class="masthead">
          <div class="row">

            <div class="col-md-3">
              <!-- CTTV logo -->
              <a href="#/"><img src="http://www.targetvalidation.org/sites/targetvalidation.org/files/CTTV_logo_webheader.png" /></a>
            </div>
            
            <div class="col-md-9" ng-controller="SearchBoxCtrl">
              <form novalidate="" name="queryForm" class="global-search ng-animate ng-dirty ng-invalid ng-invalid-required ng-valid-minlength" ng-submit="setSearch()">
                <fieldset>
                  <div class="form-group" style="position:relative"> 
                    
                    

                    <div class="input-group">
                      
                      <!--
                      <input type="text" placeholder="Search for gene or disease" class="form-control ng-valid-maxlength ng-animate ng-dirty ng-invalid ng-invalid-required ng-valid-minlength" name="text" tabindex="1" ng-model="query" autocomplete="off" required="" typeahead="item as item.title for item in getSuggestions($viewValue)" typeahead-template-url="partials/typeahead.html" typeahead-min-length="3" ng-model-options="{ debounce: 500 }">
                      -->
                      
                      <input type="text" placeholder="Search for gene or disease" class="form-control ng-valid-maxlength ng-animate ng-dirty ng-invalid ng-invalid-required ng-valid-minlength" name="text" tabindex="1" ng-model="search.query.text" ng-model-options="{ debounce: 500 }" autocomplete="off" ng-change="getSuggestions(search.query.text);">

                      <div class="input-group-btn">
                        <button type="submit" class="btn btn-primary">
                          <span class="fa fa-search fa-lg"></span>
                        </button>
                      </div>
                    </div>
                    

                    <!-- Suggestions box -->

                    <div class="search-suggestions-box ng-hide" ng-show="isVisible()" ng-cloak ng-model="search.query.results">
                      <!-- TODO: the visibility here should really use focus... not 100% happy with that query.text.length above ... -->
                      
                      <!-- Besthit -->
                      <!-- this is the heading/title for it -->
                      <!-- 
                      <div class="row">
                        <span class="col-md-4">
                          <span bind-html-unsafe="(search.results.besthit.type=='genedata' ? search.results.besthit.approved_symbol : search.results.besthit.label) | typeaheadHighlight:search.query.text"></span>
                          <span class="label label-default">{{search.results.besthit.type | limitTo:4}}</span>
                        </span>
                        <span class="col-md-8">{{ search.results.besthit.type=="genedata" ? search.results.besthit.approved_name : search.results.besthit.id }}</span>
                      </div>
                      -->

                      <div ng-click="linkTo({type:search.results.besthit.type, q:search.results.besthit.id, label:search.results.besthit.label||search.results.besthit.approved_symbol})" style="cursor:pointer;">
                        <h4 style="padding:0px 5px">
                          <span class="nbblock">
                            <a><span bind-html-unsafe="(search.results.besthit.type=='genedata' ? search.results.besthit.approved_symbol : search.results.besthit.label) | typeaheadHighlight:search.query.text"></span></a>
                            <span class="label" ng-class="(search.results.besthit.type=='genedata') ? 'label-primary' : 'label-warning'" style="font-size:12px">{{search.results.besthit.type=="genedata" ? "gene" : "disease"}}</span>
                          </span>
                          <small class="text-lowlight">{{ search.results.besthit.type=="genedata" ? search.results.besthit.approved_name : search.results.besthit.id }}</small>
                        </h4>
                        <!-- This is the longer description -->
                        <p style="margin:0px; padding:0px 5px">{{ ( search.results.besthit.type=="genedata" ? search.results.besthit.uniprot_function[0] : search.results.besthit.definition) | limitTo:300}}<span ng-show="search.results.besthit.uniprot_function[0].length>300 || search.results.besthit.definition.length>300">...</span></p>
                      </div>


                      <!-- Genes -->
                      <div ng-show="search.results.genes.length>0">
                        <div class="divider"></div>
                        <div class="text-lowlight" style="padding:0px 5px">Genes</div>
                        <div ng-repeat="item in search.results.genes" style="margin:0; padding:4px 5px" class="item">
                          <!-- <a ng-href="#/target-associations?q={{item.id}}&label={{item.approved_symbol}}"> -->
                            <div class="row" ng-click="linkTo({type:item.type, q:item.id, label:item.approved_symbol})">
                              <span class="col-md-3">
                             <span bind-html-unsafe="item.approved_symbol | typeaheadHighlight:search.query.text" class="text-nolight"></span>
                            </span>
                            <span class="col-md-9 text-lowlight"><span bind-html-unsafe="item.approved_name | typeaheadHighlight:search.query.text | limitTo: 60"></span><span ng-show="item.approved_name.length>60">...</span></span>
                            </div>
                          <!-- </a> -->
                        </div>
                      </div>


                      <!-- Diseases (EFOs) -->
                      <div ng-show="search.results.efo.length>0">
                        <div class="divider"></div>
                        <div class="text-lowlight" style="padding:0px 5px">Diseases</div>
                        <div ng-repeat="item in search.results.efo" style="padding:4px 5px" class="item">
                          <!-- #/disease-associations?q={{item.id}}&label={{item.label}} -->
                            <div ng-click="linkTo({type:item.type, q:item.id, label:item.label})">
                              <div bind-html-unsafe="item.label | typeaheadHighlight:search.query.text" style="margin-bottom:0px; line-height:1.1"></div>
                              
                              <!-- show the EFO hierarchy links -->
                              <small class="text-lowlight">
                                <span ng-show="item.path.length>2">[...]<span class="fa fa-angle-right fa-md" style="margin:0px 4px"></span></span><span ng-repeat="link in item.path" ng-if="$index==item.path.length-3 || $index==item.path.length-2 || $index==item.path.length-1"><span ng-click="linkTo({type:'efo', q:link.uri, label:link.label}); $event.stopPropagation()" title="{{link.label}}"><a>{{link.label | limitTo:30}}<span ng-show="link.label.length>30">...</span></a></span><span ng-show="!$last" class="fa fa-angle-right fa-md" style="margin:0px 4px"></span></span>
                              </small>
                            </div>
                          
                        </div>
                      </div>

                    

                    </div>
                    <!-- End suggestions box -->



                    <span class="help-block example-searches">
                      <small>
                        <i>
                          Examples: <a href="#/search?q=braf">BRAF</a>, 
                          <a href="#/search?q=carcinoma">Carcinoma</a>, 
                          <a href="#/search?q=pten">PTEN</a>
                        </i>
                      </small>
                    </span>
                    

                    <!-- Error messages -->
                    <!-- again, TODO later
                    <label class="control-label has-error ng-hide" for="query-text" ng-show="query.submitted &amp;&amp; (queryForm.text.$error.required || queryForm.text.$error.minlength)">
                      Your query is too short
                    </label>
                    <label class="control-label ng-hide" for="query-text" ng-show="query.submitted &amp;&amp; (queryForm.text.$error.maxlength)">
                      Your query is too long
                    </label>
                    -->
                  </div>
                </fieldset>
              </form>
            </div>

          </div>

        </div>


      <!-- End Masthead -->



      <!-- Content --> 

      <div ng-view></div>
      
      <!-- End Content -->



      <!-- Footer -->
      <footer class="">Version 0.1</footer>
      <!-- End Footer-->



    </div>


    <script type="text/javascript" src="bower_components/angular/angular.js"></script>
    <script type="text/javascript" src="bower_components/angular-route/angular-route.js"></script>
    <script type="text/javascript" src="bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
    <script type="text/javascript" src="bower_components/d3/d3.min.js"></script>
    <script type="text/javascript" src="vendor/Biojs.js"></script>
    <!-- <script type="text/javascript" src="bower_components/jquery/jquery.js"></script> -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="vendor/Biojs.ExpressionAtlasBaselineSummary.js"></script>

    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/controllers.js"></script>
    <script type="text/javascript" src="js/services.js"></script>
    <!-- <script type="text/javascript" src="js/d3controllers.js"></script> -->
    <script type="text/javascript" src="js/directives.js"></script>

    
</body>


