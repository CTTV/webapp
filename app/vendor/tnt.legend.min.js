!function t(e,r,n){function a(i,l){if(!r[i]){if(!e[i]){var c="function"==typeof require&&require;if(!l&&c)return c(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=r[i]={exports:{}};e[i][0].call(u.exports,function(t){var r=e[i][1][t];return a(r?r:t)},u,u.exports,t,e,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(t,e){e.exports=t("./index.js")},{"./index.js":2}],2:[function(t,e){e.exports=tnt_legend=t("./src/legend.js")},{"./src/legend.js":16}],3:[function(t,e){e.exports=t("./src/api.js")},{"./src/api.js":4}],4:[function(t,e,r){var n=function(t){var e=function(){var t=[];return t.add_batch=function(e){t.unshift(e)},t.update=function(e,r){for(var n=0;n<t.length;n++)for(var a in t[n])if(a===e)return t[n][a]=r,!0;return!1},t.add=function(e,r){if(t.update(e,r));else{var n={};n[e]=r,t.add_batch(n)}},t.get=function(e){for(var r=0;r<t.length;r++)for(var n in t[r])if(n===e)return t[r][n]},t},r=e(),n=function(){};n.check=function(e,r,a){if(!(e instanceof Array))return"function"==typeof e?e.check(r,a):t[e].check(r,a),n;for(var o=0;o<e.length;o++)n.check(e[o],r,a)},n.transform=function(e,r){if(!(e instanceof Array))return"function"==typeof e?e.transform(r):t[e].transform(r),n;for(var a=0;a<e.length;a++)n.transform(e[a],r)};var a=function(e,n){var a=[],o=[],i=n.on_getter||function(){return r.get(e)},l=n.on_setter||function(t){for(var n=0;n<o.length;n++)t=o[n](t);for(var i=0;i<a.length;i++)if(!a[i].check(t)){var l=a[i].msg||"Value "+t+" doesn't seem to be valid for this method";throw l}r.add(e,t)},c=function(e){return arguments.length?(l(e),t):i()};c.check=function(t,e){return arguments.length?(a.push({check:t,msg:e}),this):a},c.transform=function(t){return arguments.length?(o.push(t),this):o},t[e]=c},o=function(t,e){if("object"==typeof t){r.add_batch(t);for(var n in t)a(n,e)}else r.add(t,e.default_value),a(t,e)};return n.getset=function(t,e){return o(t,{default_value:e}),n},n.get=function(t,e){var r=function(){throw"Method defined only as a getter (you are trying to use it as a setter"};return o(t,{default_value:e,on_setter:r}),n},n.set=function(t,e){var r=function(){throw"Method defined only as a setter (you are trying to use it as a getter"};return o(t,{default_value:e,on_getter:r}),n},n.method=function(e,r){if("object"==typeof e)for(var a in e)t[a]=e[a];else t[e]=r;return n},n};e.exports=r=n},{}],5:[function(t,e){e.exports=board=t("./src/index")},{"./src/index":9}],6:[function(t,e,r){var n=t("tnt.api"),a=t("tnt.utils").defer_cancel,o=function(){"use strict";function t(t){t.parentNode.appendChild(t)}var e,r,o,i,l,c=[],u=50,s=0,f=920,d=20,h={species:void 0,chr:void 0,from:0,to:500},g=d3.rgb("#F8FBEF"),p=d3.behavior.zoom(),v={left:0,right:1e3,zoom_out:1e3,zoom_in:100},m=3,_=500,x=!0,y={ease:d3.ease("cubic-in-out"),extend_canvas:{left:0,right:0},show_frame:!0},b=function(t){r=d3.select(t).attr("id"),d3.select(t).classed("tnt",!0);var n=d3.select(t).append("div").attr("id","tnt_"+r).style("position","relative").classed("tnt_framed",y.show_frame?!0:!1).style("width",f+2*m+y.extend_canvas.right+y.extend_canvas.left+"px"),a=n.append("div").attr("class","tnt_groupDiv");e=a.append("svg").attr("class","tnt_svg").attr("width",f).attr("height",s).attr("pointer-events","all"),i=e.append("g").attr("transform","translate(0,20)").append("g").attr("class","tnt_g"),i.append("rect").attr("id","tnt_"+r+"_5pcap").attr("x",0).attr("y",0).attr("width",0).attr("height",s).attr("fill","red"),i.append("rect").attr("id","tnt_"+r+"_3pcap").attr("x",f-m).attr("y",0).attr("width",0).attr("height",s).attr("fill","red"),o=i.append("rect").attr("class","tnt_pane").attr("id","tnt_"+r+"_pane").attr("width",f).attr("height",s).style("fill",g)},w=n(b).getset(y).getset(v).getset(h);w.transform(b.extend_canvas,function(t){var e=b.extend_canvas();return t.left=t.left||e.left,t.right=t.right||e.right,t}),w.method("start",function(){for(var t=0;t<c.length;t++)c[t].g&&c[t].display().reset.call(c[t]),A(c[t]);j();var e=function(t){v.right=t,h.to-h.from<v.zoom_in&&(h.to=h.from+v.zoom_in>v.zoom_in?v.right:h.from+v.zoom_in),z();for(var e=0;e<c.length;e++)k(c[e],h)};"function"==typeof v.right?v.right(e):e(v.right)}),w.method("update",function(){for(var t=0;t<c.length;t++)k(c[t])});var k=function(t,e){if(t.data()){var r=t.data().update();r({loc:e,on_success:function(){t.display().update.call(t,l)}})}},z=function(){l=d3.scale.linear().domain([h.from,h.to]).range([0,f]),x&&i.call(p.x(l).scaleExtent([(h.to-h.from)/(v.zoom_out-1),(h.to-h.from)/v.zoom_in]).on("zoom",F))};w.method("move_right",function(t){t>0&&q(t,1)}),w.method("move_left",function(t){t>0&&q(t,-1)}),w.method("zoom",function(t){q(t,0)}),w.method("find_track_by_id",function(t){for(var e=0;e<c.length;e++)if(c[e].id()===t)return c[e]}),w.method("reorder",function(t){for(var e=0;e<t.length;e++){for(var r=!1,n=0;n<c.length;n++)if(c[n].id()===t[e].id()){r=!0,c.splice(n,1);break}r||(A(t[e]),k(t[e],{from:h.from,to:h.to}))}for(var a=0;a<c.length;a++)c[a].g.remove();c=t,j()}),w.method("remove_track",function(t){t.g.remove()}),w.method("add_track",function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)b.add_track(t[e]);return b}return c.push(t),b}),w.method("tracks",function(t){return arguments.length?(c=t,b):c}),w.method("width",function(t){if(!arguments.length)return f;if(u>t&&(t=u),void 0!==r){d3.select("#tnt_"+r).select("svg").attr("width",t),d3.select("#tnt_"+r).style("width",parseInt(t)+2*m+"px"),d3.select("#tnt_"+r+"_pane").attr("width",t),f=t,z();for(var e=0;e<c.length;e++)c[e].g.select("rect").attr("width",t),c[e].display().reset.call(c[e]),c[e].display().update.call(c[e],l)}else f=t;return b}),w.method("allow_drag",function(t){return arguments.length?(x=t,x?void 0!==l&&i.call(p.x(l).scaleExtent([(h.to-h.from)/(v.zoom_out-1),(h.to-h.from)/v.zoom_in]).on("zoom",F)):p.x(d3.scale.linear()).on("zoom",null),b):x});var j=function(){for(var n=0,a=0;a<c.length;a++){var i=c[a];i.g.attr("transform")?i.g.transition().duration(_).attr("transform","translate(0,"+n+")"):i.g.attr("transform","translate(0,"+n+")"),n+=i.height()}return e.attr("height",n+d),d3.select("#tnt_"+r).style("height",n+10+d+"px"),d3.select("#tnt_"+r+"_5pcap").attr("height",n).each(function(){t(this)}),d3.select("#tnt_"+r+"_3pcap").attr("height",n).each(function(){t(this)}),o.attr("height",n+d),b},A=function(t){return t.g=e.select("g").select("g").append("g").attr("class","tnt_track").attr("height",t.height()),t.g.append("rect").attr("x",0).attr("y",0).attr("width",b.width()).attr("height",t.height()).style("fill",t.background_color()).style("pointer-events","none"),t.display()&&t.display().init.call(t,f),b},q=function(t,e){var r,n=l.domain(),a=n[1]-n[0],o=a*t-a;switch(e){case-1:r=[~~n[0]-o,~~(n[1]-o)];break;case 1:r=[~~n[0]+o,~~(n[1]-o)];break;case 0:r=[n[0]-~~(o/2),n[1]+~~o/2]}var i=d3.interpolateNumber(n[0],r[0]),c=y.ease,u=0;d3.timer(function(){var t,r=i(c(u));switch(e){case-1:t=r+a;break;case 1:t=r+a;break;case 0:t=n[1]+n[0]-r}var o=[r,t];return l.domain(o),F(l),u+=.02,u>1})},C=function(){var t=l.domain();b.from(~~t[0]),b.to(~~t[1]);for(var e=0;e<c.length;e++){var r=c[e];k(r,h)}},E=a(C,300),F=function(t){void 0!==t&&x&&p.x(t);var e=l.domain();e[0]<=5&&d3.select("#tnt_"+r+"_5pcap").attr("width",m).transition().duration(200).attr("width",0),e[1]>=v.right-5&&d3.select("#tnt_"+r+"_3pcap").attr("width",m).transition().duration(200).attr("width",0),e[0]<v.left?p.translate([p.translate()[0]-l(v.left)+l.range()[0],p.translate()[1]]):e[1]>v.right&&p.translate([p.translate()[0]-l(v.right)+l.range()[1],p.translate()[1]]),E();for(var n=0;n<c.length;n++){var a=c[n];a.display().move.call(a,l)}};return b};e.exports=r=o},{"tnt.api":3,"tnt.utils":12}],7:[function(t,e,r){var n=t("tnt.api"),a=function(){"use strict";var t=function(){};return n(t).getset("label","").getset("elements",[]).getset("update",function(){}),a.retriever={},a.retriever.sync=function(){var e=function(r){t.elements(e.retriever()(r.loc)),r.on_success()};return n(e).getset("retriever",function(){}),e},a.retriever.async=function(){var e="",r=function(r){d3.json(e,function(e,n){t.elements(n),r.on_success()})};return n(r).getset("url",""),r},t};a.empty=function(){var t=a(),e=a.retriever.sync();return t.update(e),t},e.exports=r=a},{"tnt.api":3}],8:[function(t,e,r){var n=t("tnt.api"),a=t("./layout.js"),o=function(){var t={create:function(){throw"create_elem is not defined in the base feature object"},mover:function(){throw"move_elem is not defined in the base feature object"},updater:function(){},on_click:function(){},on_mouseover:function(){},guider:function(){},index:void 0,layout:a.identity(),foreground_color:"#000"},e={},r=function(){var t=this;t.g.selectAll(".tnt_elem").remove(),t.g.selectAll(".tnt_guider").remove()},o=function(e){var r=this;t.guider.call(r,e)},i=function(e,r,n){e.on("click",t.on_click),e.on("mouseover",t.on_mouseover),t.create.call(r,e,n)},l=function(r,n){var a=this,o=a.g,i=t.layout,l=a.data().elements();void 0!==n&&(l=l[n]),i(l,r);var c,u,s=i.elements();c=o.selectAll(void 0!==n?".tnt_elem_"+n:".tnt_elem"),u=t.index?c.data(s,function(e){return void 0!==e?t.index(e):void 0}):c.data(s),t.updater.call(a,u,r);var f=u.enter();f.append("g").attr("class","tnt_elem").classed("tnt_elem_"+n,n).call(e.plot,a,r),u.exit().remove()},c=function(e,r){var n,a=this,o=a.g;n=o.selectAll(void 0!==r?".tnt_elem_"+r:".tnt_elem"),t.mover.call(this,n,e)},u=function(t){if(void 0!==t){var e=this,r=e.g;r.selectAll(".tnt_elem_"+t).move_to_front()}};return n(e).getset(t).method({reset:r,plot:i,update:l,move:c,init:o,move_to_front:u}),e};o.composite=function(){var t={},e=[],r={},a=function(){for(var e=this,r=0;r<t.length;r++)t[r].reset.call(e)},o=function(e){var r=this;for(var n in t)t.hasOwnProperty(n)&&t[n].init.call(r,e)},i=function(r){for(var n=this,a=0;a<e.length;a++)t[e[a]].update.call(n,r,e[a]),t[e[a]].move_to_front.call(n,e[a])},l=function(e){var r=this;for(var n in t)t.hasOwnProperty(n)&&t[n].move.call(r,e,n)},c=function(n,a){return t[n]=a,e.push(n),r};return n(r).method({reset:a,update:i,move:l,init:o,add:c}),r},o.sequence=function(){{var t=o(),e={fontsize:10,sequence:function(t){return t.sequence}};n(t).getset(e)}return t.create(function(r,n){var a=this;r.append("text").attr("fill",a.background_color()).style("font-size",e.fontsize+"px").attr("x",function(t){return n(t.pos)}).attr("y",function(){return~~(a.height()/2)+5}).text(e.sequence).transition().duration(500).attr("fill",t.foreground_color())}),t.mover(function(t,e){t.select("text").attr("x",function(t){return e(t.pos)})}),t},o.gene=function(){var t=o().layout(a.feature()).index(function(t){return t.id});return t.create(function(e,r){var n=this;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",n.background_color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.foreground_color():e.color}),e.append("text").attr("class","tnt_name").attr("x",function(t){return r(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).attr("fill",n.background_color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(){return t.foreground_color()})}),t.updater(function(e){e.select("rect").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("height",t.layout().gene_slot().gene_height),e.select("text").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.mover(function(t,e){t.select("rect").attr("x",function(t){return e(t.start)}).attr("width",function(t){return e(t.end)-e(t.start)}),t.select("text").attr("x",function(t){return e(t.start)})}),t},o.area=function(){var t,e=o.line(),r=o.line(),n=d3.svg.area().interpolate(r.interpolate()).tension(e.tension()),a=e.create();e.create(function(o,i){var l=this;void 0!==t&&l.g.select("path").remove(),a.call(l,o,i),n.x(r.x()).y1(r.y()).y0(l.height()),t=o.data(),o.remove(),l.g.append("path").attr("class","tnt_area").classed("tnt_elem",!0).datum(t).attr("d",n).attr("fill",d3.rgb(e.foreground_color()).brighter())});var i=e.mover();return e.mover(function(e,a){var o=this;i.call(o,e,a),n.x(r.x()),o.g.select(".tnt_area").datum(t).attr("d",n)}),e},o.line=function(){var t=o(),e=function(t){return t.pos},r=function(t){return t.val},n=.7,a=d3.scale.linear(),i=d3.svg.line().interpolate("basis");t.line=function(){return i},t.x=function(r){return arguments.length?(e=r,t):e},t.y=function(e){return arguments.length?(r=e,t):r},t.tension=function(e){return arguments.length?(n=e,t):n};var l;return t.create(function(o,c){var u=this;void 0!==l&&u.g.select("path").remove(),i.tension(n).x(function(t){return c(e(t))}).y(function(t){return u.height()-a(r(t))}),l=o.data(),o.remove(),a.domain([0,1]).range([0,u.height()-2]),u.g.append("path").attr("class","tnt_elem").attr("d",i(l)).style("stroke",t.foreground_color()).style("stroke-width",4).style("fill","none")}),t.mover(function(t,r){var n=this;i.x(function(t){return r(e(t))}),n.g.select("path").attr("d",i(l))}),t},o.conservation=function(){var t=o.area(),e=t.create();return t.create(function(t,r){var n=this;e.call(n,d3.select(t[0][0]),r)}),t},o.ensembl=function(){var t=o(),e="#7FFF00",r="#00BB00";return t.guider(function(e){var r=this,n=~~(r.height()-.8*r.height())/2;r.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",n).attr("y2",n).style("stroke",t.foreground_color()).style("stroke-width",1),r.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",r.height()-n).attr("y2",r.height()-n).style("stroke",t.foreground_color()).style("stroke-width",1)}),t.create(function(e,r){var n=this,a=~~(n.height()-.8*n.height())/2;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",a).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",n.height()-~~(2*a)).attr("fill",n.background_color()).transition().duration(500).attr("fill",function(e){return d3.rgb("high"===e.type?t.foreground_color():"low"===e.type?t.foreground_color2():t.foreground_color3())})}),t.updater(function(t,e){t.select("rect").attr("width",function(t){return e(t.end)-e(t.start)})}),t.mover(function(t,e){t.select("rect").attr("x",function(t){return e(t.start)}).attr("width",function(t){return e(t.end)-e(t.start)})}),t.foreground_color2=function(r){return arguments.length?(e=r,t):e},t.foreground_color3=function(e){return arguments.length?(r=e,t):r},t},o.vline=function(){var t=o();return t.create(function(e,r){var n=this;e.append("line").attr("x1",function(e){return r(t.index()(e))}).attr("x2",function(e){return r(t.index()(e))}).attr("y1",0).attr("y2",n.height()).attr("stroke",t.foreground_color()).attr("stroke-width",1)}),t.mover(function(e,r){e.select("line").attr("x1",function(e){return r(t.index()(e))}).attr("x2",function(e){return r(t.index()(e))})}),t},o.block=function(){var t=o();return n(t).getset("from",function(t){return t.start}).getset("to",function(t){return t.end}),t.create(function(e,r){var n=this;e.append("rect").attr("x",function(e,n){return r(t.from()(e,n))}).attr("y",0).attr("width",function(e,n){return r(t.to()(e,n))-r(t.from()(e,n))}).attr("height",n.height()).attr("fill",n.background_color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.foreground_color():e.color})}),t.updater(function(t,e){t.select("rect").attr("width",function(t){return e(t.end)-e(t.start)})}),t.mover(function(t,e){t.select("rect").attr("x",function(t){return e(t.start)}).attr("width",function(t){return e(t.end)-e(t.start)})}),t},o.axis=function(){var t,e="top",r={};return r.reset=function(){t=void 0;var e=this;e.g.selectAll("rect").remove(),e.g.selectAll(".tick").remove()},r.plot=function(){},r.move=function(){var e=this,r=e.g;r.call(t)},r.init=function(){},r.update=function(r){void 0===t&&(t=d3.svg.axis().scale(r).orient(e));var n=this,a=n.g;a.call(t)},r.orientation=function(t){return arguments.length?(e=t,r):e},r},o.location=function(){var t,e={};return e.reset=function(){},e.plot=function(){},e.init=function(){},e.move=function(e){var r=e.domain();t.select("text").text("Location: "+~~r[0]+"-"+~~r[1])},e.update=function(e){var r=this,n=r.g,a=e.domain();void 0===t&&(t=n,t.append("text").text("Location: "+~~a[0]+"-"+~~a[1]))},e},e.exports=r=o},{"./layout.js":10,"tnt.api":3}],9:[function(t,e,r){var n=t("./board.js");n.track=t("./track"),n.track.data=t("./data.js"),n.track.layout=t("./layout.js"),n.track.feature=t("./feature.js"),e.exports=r=n},{"./board.js":6,"./data.js":7,"./feature.js":8,"./layout.js":10,"./track":11}],10:[function(t,e,r){var n=t("tnt.api");layout={},layout.identity=function(){{var t,e=function(e){t=e};n(e).method({height:function(){},elements:function(){return t}})}return e},layout.feature=function(){{var t,e={height:150,scale:void 0},r={elements:[]},a={expanded:{slot_height:30,gene_height:10,show_label:!0},collapsed:{slot_height:10,gene_height:7,show_label:!1}},o="expanded",i=function(n,l){for(var u=0;u<n.length;u++)null===n[u].external_name&&(n[u].external_name="");t=~~(e.height/a.expanded.slot_height)-1,void 0!==l&&i.scale(l),s(n,r.elements);var f=c(n);o=f>t?"collapsed":"expanded",r.elements=n},l=function(){return a[o]},c=function(e){for(var r=[],n=e,a=0,o=0;o<e.length;o++)e[o].slot>a&&e[o].slot<t&&(a=e[o].slot);for(var o=0;o<n.length;o++){var i=d(r),l=n[o];if(void 0!==l.slot&&l.slot<t&&u(l,i[l.slot]))r.push(l);else for(var c=0;;){if(u(l,i[c])){l.slot=c,r.push(l),c>a&&(a=c);break}c++}}return a+1},u=function(t,r){if(void 0===r)return!0;for(var n=0;n<r.length;n++){var a=r[n];if(t.id!==a.id){var o=8*a.display_label.length+e.scale(a.start),i=e.scale(a.start),l=e.scale(a.end)>o?e.scale(a.end):o,c=8*t.display_label.length+e.scale(t.start),u=e.scale(t.start),s=e.scale(t.end)>c?e.scale(t.end):c;if(i>u&&s>i||u>i&&l>u)return!1}}return!0},s=function(t,e){for(var r=f(e),n=0;n<t.length;n++)void 0!==r[t[n].id]&&(t[n].slot=r[t[n].id])},f=function(t){for(var e={},r=0;r<t.length;r++){var n=t[r];e[n.id]=n.slot}return e},d=function(t){for(var e=[],r=0;r<t.length;r++)void 0===e[t[r].slot]&&(e[t[r].slot]=[]),e[t[r].slot].push(t[r]);return e};n(i).getset(e).get(r).method({gene_slot:l})}return i},e.exports=r=layout},{"tnt.api":3}],11:[function(t,e,r){var n=t("tnt.api"),a=t("tnt.utils").iterator,o=function(){"use strict";{var t,e={id:o.id()},r={background_color:d3.rgb("#CCCCCC"),height:250,data:o.data.empty()},a=function(){};n(a).getset(r).get(e)}return a.display=function(e){if(!arguments.length)return t;if(t=e,"function"==typeof t)t.layout&&t.layout().height(r.height);else for(var n in t)t.hasOwnProperty(n)&&t[n].layout&&t[n].layout().height(r.height);return a},a};o.id=a(1),e.exports=r=o},{"tnt.api":3,"tnt.utils":12}],12:[function(t,e){e.exports=t("./src/index.js")},{"./src/index.js":13}],13:[function(t,e,r){var n=t("./utils.js");n.reduce=t("./reduce.js"),e.exports=r=n},{"./reduce.js":14,"./utils.js":15}],14:[function(t,e){var r=function(){var t=5,e="val",r=function(t,e){return e>t?.2*e>=e-t:.2*t>=t-e},n=function(t){return t},a=function(t){if(!t.length)return t;var e=l(t),r=n(e);return r},o=function(t,r){if(r.sort(function(t,r){return t[e]-r[e]}),r.length%2)t[e]=r[~~(r.length/2)][e];else{var n=~~(r.length/2)-1;t[e]=(r[n][e]+r[n+1][e])/2}return t},i=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},l=function(e){if(0===t)return e;for(var r=[],n=0;n<e.length;n++){var a=t>n?0:n-t,l=n>e.length-t?e.length:n+t;r[n]=o(i(e[n]),e.slice(a,l+1))}return r};return a.reducer=function(t){return arguments.length?(n=t,a):n},a.redundant=function(t){return arguments.length?(r=t,a):r},a.value=function(t){return arguments.length?(e=t,a):e},a.smooth=function(e){return arguments.length?(t=e,a):t},a},n=function(){var t=r().value("start"),e="end",n=function(r,n){return{object:{start:r.object[t.value()],end:n[e]},value:n[e]}};return t.reducer(function(r){for(var a=t.value(),o=t.redundant(),i=[],l={object:r[0],value:r[0][e]},c=1;c<r.length;c++)o(r[c][a],l.value)?l=n(l,r[c]):(i.push(l.object),l.object=r[c],l.value=r[c].end);return i.push(l.object),i}),r.join=function(e){return arguments.length?(n=e,t):n},r.value2=function(r){return arguments.length?(e=r,t):e},t},a=function(){var t=r();return t.reducer(function(e){for(var r=t.redundant(),n=t.value(),a=[],o=e[0],i=1;i<e.length-1;i++)r(e[i][n],o[n])||(a.push(o),o=e[i]);return a.push(o),a.push(e[e.length-1]),a}),t};e.exports=r,e.exports.line=a,e.exports.block=n},{}],15:[function(t,e){e.exports={iterator:function(t){var e=t||0,r=function(){return e++};return r},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),r=new RegExp(e+"$"),n=new RegExp("(.*)"+e+"$"),a=document.getElementsByTagName("script"),o="";if(void 0!==a)for(var i in a)if(a[i].src&&a[i].src.match(r))return a[i].src.replace(n,"$1");return o},defer_cancel:function(t,e){var r,n=function(){clearTimeout(r),r=setTimeout(t,e)};return n}}},{}],16:[function(t,e,r){var n=t("tnt.api"),a=t("tnt.board"),o=t("tnt.utils").iterator,i=function(t){d3.select(t).attr("class","tnt_framed");var e={row_height:20,width:140,fontsize:12},r=o(1),i=[],l=function(){for(var t=0;t<i.length;t++){var e=i[t];e.board(e.div),e.board.start()}},c=n(l).getset(e);c.method("add_column",function(){var n=d3.select(t).style("display","table").attr("id"),o=d3.select(t).append("div").attr("id",n+"_"+r()).style("display","table-cell"),l=a().right(2).from(1).to(2).allow_drag(!1).show_frame(!1).width(e.width);return l.add_row=l.add_track,i.push({div:o.node(),board:l}),l}),c.method("header",function(){var t=a.track.feature();t.create(function(t,e){var r=this;t.append("text").attr("fill","black").attr("font-size",r.fontsize()).attr("x",e(1)).attr("y",~~r.height()/2).attr("font-weight","bold").text(r.text())});var e=u().display(t);return e}),c.method("text",function(){var t=u().deploy(function(){var e=this;d3.select(e).append("text").attr("x",0).attr("y",~~(t.height()/2)+4).attr("fill",t.color()).attr("font-size",t.fontsize()).text(t.feature_text())});return n(t).getset("feature_text",""),t}),c.method("hline",function(){var t=u().deploy(function(){var e=this;d3.select(e).append("line").attr("x1",0).attr("x2",t.feature_width()).attr("y1",~~(t.height()/2)).attr("y2",~~(t.height()/2)).attr("stroke-width",2).attr("stroke",t.color())});return t}),c.method("vline",function(){var t=u().deploy(function(){var e=this;d3.select(e).append("line").attr("stroke",t.color()).attr("stroke-width",2).attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",t.height())});return t}),c.method("square",function(){var t=u().deploy(function(){var e=~~(.8*t.height()),r=this;d3.select(r).append("rect").attr("x",0).attr("y",t.height()-e).attr("width",e).attr("height",e).attr("fill",t.color())});return t}),c.method("circle",function(){var t=a.track.feature();t.create(function(t){var e=this,r=~~(e.height()/2);t.append("circle").attr("cx",r).attr("cy",~~(r/2)).attr("r",r-2).attr("fill",e.color()),t.append("text").attr("fill","black").attr("font-size",e.fontsize()).attr("x",40).attr("y",~~(e.height()/2+4)).text(e.text())});var e=u().display(t);return e}),c.method("gradient",function(){var e=a.track.feature();e.create(function(e){var r=100,n=this,a=e.append("linearGradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%").attr("id",d3.select(t).attr("id")+"_gradient");a.append("stop").attr("offset","0%").attr("stop-color",n.color1()).attr("stop-opacity",1),a.append("stop").attr("offset","100%").attr("stop-color",n.color2()).attr("stop-opacity",1);{var o=d3.scale.linear().domain([n.from(),n.to()]).range([0,r]),i=d3.svg.axis().scale(o).tickSize(0).ticks(3),l=e.append("g").attr("transform","translate(5,0)");e.append("g").attr("transform","translate(5,"+(n.height()-10)+")").call(i)}l.append("rect").attr("x",0).attr("y",0).attr("width",r).attr("height",~~(n.height()-10)).attr("fill","url(#"+d3.select(t).attr("id")+"_gradient)"),l.append("text").attr("fill","black").attr("font-size",n.fontsize()).attr("x",110).attr("y",~~(n.height()/2)).text(n.text())});var r=u().display(e);r.color=void 0;var o=n(r);return o.getset("color1","yellow").getset("color2","red").getset("from",0).getset("to",100),r}),c.method("range",function(){var e=a.track.feature();e.create(function(e){function r(){}function n(){console.log(u.extent()),s.selectAll(".tnt_legend_rect").attr("fill","url(#"+d3.select(t).attr("id")+"_range)"),s.selectAll(".tnt_legend_range_pre").attr("width",c(u.extent()[0])-1),s.selectAll(".tnt_legend_range_post").attr("x",c(u.extent()[1])+1).attr("width",i-c(u.extent()[1])),o.on_change().call(u)}function a(){console.log(u.extent())}var o=this,i=100,l=e.append("linearGradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%").attr("id",d3.select(t).attr("id")+"_range");l.append("stop").attr("offset","0%").attr("stop-color",o.color1()).attr("stop-opacity",1),l.append("stop").attr("offset","100%").attr("stop-color",o.color2()).attr("stop-opacity",1);var c=d3.scale.linear().domain([o.from(),o.to()]).range([0,i]),u=d3.svg.brush().x(c).extent([o.from(),o.to()]).on("brushstart",r).on("brush",n).on("brushend",a),s=e.append("g").attr("transform","translate(5,5)").call(u);s.selectAll(".resize").append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",o.height()/2-2).style("stroke","black").style("stroke-width",2),s.selectAll(".resize").append("path").attr("d","M0,0L-3,-4L3,-4L0,0").attr("fill","black"),s.selectAll("rect").classed("tnt_legend_range",!0).attr("height",o.height()/2-2).attr("fill","url(#"+d3.select(t).attr("id")+"_range)"),s.append("rect").attr("class","tnt_legend_range_pre").attr("x",0).attr("y",0).attr("height",o.height()/2-2).attr("fill",o.color1()),s.append("rect").attr("class","tnt_legend_range_post").attr("y",0).attr("height",o.height()/2-2).attr("fill",o.color2()),r(),n();{var f=d3.svg.axis().scale(c).tickSize(0).ticks(3);e.append("g").attr("transform","translate(5,"+(o.height()-10)+")").call(f)}e.append("text").attr("fill","black").attr("font-size",o.fontsize()).attr("x",115).attr("y",~~(o.height()/2+3)).text(o.text())});var r=u().display(e);r.color=void 0;var o=n(r);return o.getset("color1","yellow").getset("color2","red").getset("from",0).getset("to",100).getset("on_change",function(){}),r}),c.method("empty",function(){var t=a.track().height(e.row_height).background_color("white").data(null).display(null);return t});var u=function(){var t=a.track.feature();t.create(function(t){var e=this,r=t.append("g");e.deploy().call(r.node()),t.append("g").attr("transform","translate("+(e.feature_width()+5)+", 0)").append("text").attr("fill","black").attr("x",0).attr("y",~~(e.height()/2)+4).attr("font-size",e.fontsize()).text(e.text())});{var r=a.track();n(r).getset("color","black").getset("text","").getset("height",e.row_height).getset("fontsize",e.fontsize).getset("feature_width",40).getset("deploy",function(){throw"deploy is not defined in the legend base class"})}return r.height(r.height()).background_color("white").data(a.track.data().update(a.track.data.retriever.sync().retriever(function(){return[{}]}))).display(t),r};return l};e.exports=r=i},{"tnt.api":3,"tnt.board":5,"tnt.utils":12}]},{},[1]);